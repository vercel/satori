import { it, describe, expect } from 'vitest'

import { initFonts, toImage } from './utils.js'
import satori from '../src/index.js'

describe('Emojis', () => {
  let fonts
  initFonts((f) => (fonts = f))

  it('should detect emojis correctly', async () => {
    const emojis = []
    await satori(<div>⛷👨‍👩‍👧❤️‍🔥🏳️‍🌈㊗️🛠👶🏾</div>, {
      width: 100,
      height: 100,
      fonts,
      loadAdditionalAsset: async (languageCode, segment) => {
        if (languageCode === 'emoji') {
          emojis.push(segment)
        }
        return 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPj/HwADBwIAMCbHYQAAAABJRU5ErkJggg=='
      },
    })
    expect(emojis).toMatchInlineSnapshot(`
      [
        "⛷",
        "👨‍👩‍👧",
        "❤️‍🔥",
        "🏳️‍🌈",
        "㊗️",
        "🛠",
        "👶🏾",
      ]
    `)
  })

  // https://github.com/vercel/satori/issues/302
  it('should render emojis correctly', async () => {
    const svg = await satori(
      <div
        style={{
          backgroundColor: '#fff',
        }}
      >
        🌈 🏳️‍🌈 Luci, 👨‍👨‍👧Nyan👨‍👨‍👧‍👧
      </div>,
      {
        width: 200,
        height: 100,
        fonts,
        graphemeImages: {
          '🌈': 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iIzg3NjdBQyIgZD0iTTM2IDFDMTYuMTE4IDEgMSAxNi4xMTggMSAzNmgxNy4wNDJjMC05LjkxNyA4LjA0Mi0xNy45NTggMTcuOTU4LTE3Ljk1OFYxeiIvPjxwYXRoIGZpbGw9IiNFQjIwMjciIGQ9Ik0wIDM1Ljk5OWgzLjA0MmMwLTE4LjE4OSAxNC43MzQtMzIuOTM1IDMyLjkxNy0zMi45NTdWMEMxNi4wOTUuMDIzIDAgMTYuMTMxIDAgMzUuOTk5eiIvPjxwYXRoIGZpbGw9IiNGMTkwMjAiIGQ9Ik0zLjA4MyAzNmgzQzYuMDgzIDE5LjQ2OCAxOS40NzMgNi4wNjUgMzYgNi4wNDN2LTNDMTcuODE3IDMuMDY1IDMuMDgzIDE3LjgxMSAzLjA4MyAzNnoiLz48cGF0aCBmaWxsPSIjRkZDQjRDIiBkPSJNNi4wODMgMzZoM0M5LjA4MyAyMS4xMjUgMjEuMTMgOS4wNjUgMzYgOS4wNDN2LTNDMTkuNDczIDYuMDY1IDYuMDgzIDE5LjQ2OCA2LjA4MyAzNnoiLz48cGF0aCBmaWxsPSIjNUM5MDNGIiBkPSJNOS4wODMgMzZoM2MwLTEzLjIxNyAxMC43MDUtMjMuOTM1IDIzLjkxNy0yMy45NTd2LTNDMjEuMTMgOS4wNjUgOS4wODMgMjEuMTI1IDkuMDgzIDM2eiIvPjxwYXRoIGZpbGw9IiMyMjY3OTgiIGQ9Ik0xMi4wODMgMzZoM2MwLTExLjU2IDkuMzYyLTIwLjkzNCAyMC45MTctMjAuOTU2di0zLjAwMUMyMi43ODggMTIuMDY1IDEyLjA4MyAyMi43ODMgMTIuMDgzIDM2eiIvPjwvc3ZnPg==',
          '🏳️‍🌈': 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZmlsbD0iIzg4MDA4MiIgZD0iTTAgMjdhNCA0IDAgMCAwIDQgNGgyOGE0IDQgMCAwIDAgNC00di0uNUgwdi41eiIvPjxwYXRoIGZpbGw9IiMzNTU4QTAiIGQ9Ik0wIDIyLjA3aDM2djQuNkgweiIvPjxwYXRoIGZpbGw9IiMxMzhGM0UiIGQ9Ik0wIDE3LjgzaDM2djQuNUgweiIvPjxwYXRoIGZpbGw9IiNGQUQyMjAiIGQ9Ik0wIDEzLjVoMzZWMThIMHoiLz48cGF0aCBmaWxsPSIjRkY3MzAwIiBkPSJNMCA5LjE3aDM2djQuNUgweiIvPjxwYXRoIGZpbGw9IiNGRjAwMEUiIGQ9Ik0zMiA1SDRhNCA0IDAgMCAwLTQgNHYuMzNoMzZWOWE0IDQgMCAwIDAtNC00eiIvPjwvc3ZnPg==',
          '👨‍👨‍👧': 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iI0ZGREM1RCIgZD0iTTI2IDIydi00aDV2NGgydjZoLTl2LTZ6Ii8+PHBhdGggZmlsbD0iIzNCOTNEOSIgZD0iTTMxIDIybC0yLjUyOCAzLjc3OEwyNiAyMmgtNWMtMiAwLTMgMS0zIDIuOTczVjM2aDE4VjIyaC01eiIvPjxwYXRoIGZpbGw9IiMxQjYzOTkiIGQ9Ik0yMC45ODYgMjZoMS4wMjh2MTBoLTEuMDI4eiIvPjxwYXRoIGZpbGw9IiNGRkRDNUQiIGQ9Ik0yMSA0bC4wMjQgMTBjLjAxMS4xNzUuMDM2LjM0Ny4wNTkuNTE4LjQ5NCAzLjY0IDMuNjE4IDYuNDUgNy40MTcgNi40NSAzLjk3OCAwIDcuMjIzLTMuMDc5IDcuNDc2LTYuOTY5SDM2VjRIMjF6Ii8+PHBhdGggZmlsbD0iI0ZGQUMzMyIgZD0iTTE5LjA0MiA4Ljg2MWMwIDIuMTUxLjc2NyA0LjEyMyAyLjA0MiA1LjY1OC0uMDIzLS4xNzItLjA0OC0uMzQzLS4wNTktLjUxOGwtLjAxLTQuMDMzYzUuMzYyLS4zMDIgOC41MTMtMi42NzUgMTAuMjAyLTQuNTdDMzEuNzgyIDcuMTcgMzMuMTE0IDEwIDM1Ljg2MSAxMEgzNlYxLjg4N0MzNC45MDYgMS4yMDYgMzMuNjE5LjgwNiAzMi4yMzYuODA2Yy0uMjAxIDAtLjM5OC4wMTQtLjU5NS4wM0MzMC41MDQuMzA1IDI5LjI0IDAgMjcuOTAyIDBjLTQuODk0IDAtOC44NiAzLjk2Ny04Ljg2IDguODYxeiIvPjxwYXRoIGZpbGw9IiNCRjY5NTIiIGQ9Ik0yNS4yNzggMTcuNzIzaDYuNDQ0cy0uODA1IDEuNjEtMy4yMjIgMS42MS0zLjIyMi0xLjYxLTMuMjIyLTEuNjF6TTI4IDE1LjVoMWMuMjc2IDAgLjUtLjIyNC41LS41cy0uMjI0LS41LS41LS41aC0xYy0uMjc2IDAtLjUuMjI0LS41LjVzLjIyNC41LjUuNXoiLz48cGF0aCBmaWxsPSIjNjYyMTEzIiBkPSJNMzIgMTNjLjU1MiAwIDEtLjQ0OCAxLTF2LTFjMC0uNTUyLS40NDgtMS0xLTFzLTEgLjQ0OC0xIDF2MWMwIC41NTIuNDQ4IDEgMSAxem0tNyAwYy41NTIgMCAxLS40NDggMS0xdi0xYzAtLjU1Mi0uNDQ4LTEtMS0xcy0xIC40NDgtMSAxdjFjMCAuNTUyLjQ0OCAxIDEgMXoiLz48cGF0aCBmaWxsPSIjRkZEQzVEIiBkPSJNNSAyMnYtNGg1djRoMnY2SDN2LTZ6Ii8+PHBhdGggZmlsbD0iIzNCOTREOSIgZD0iTTE1IDIyaC01bC0yLjQ3MiAzLjc3OEw1IDIySDB2MTRoMThWMjQuOTczQzE4IDIzIDE3IDIyIDE1IDIyeiIvPjxwYXRoIGZpbGw9IiMxQjYzOTkiIGQ9Ik0xMy45ODYgMjZoMS4wMjh2MTBoLTEuMDI4eiIvPjxwYXRoIGZpbGw9IiNGRkRDNUQiIGQ9Ik0xNSAxNFY1TDAgNHYxMGguMDI0Yy4yNTIgMy44OSAzLjQ5OCA2Ljk2OSA3LjQ3NiA2Ljk2OSAzLjc5MSAwIDYuOTMyLTIuNzk5IDcuNDM4LTYuNDI4LjAyNS0uMTguMDUtLjM1OC4wNjItLjU0MXoiLz48cGF0aCBmaWxsPSIjRkZBQzMzIiBkPSJNMy44MDYuODA2QzIuNDA1LjgwNiAxLjEwMiAxLjIxNSAwIDEuOTEydjguMDgzYzUuOTQ3LS4wNTUgOS4zNzUtMi41OTMgMTEuMTYyLTQuNTk4LjUwNiAxLjU4OSAxLjYzMyA0LjAyMSAzLjgzOCA0LjUxVjE0Yy0uMDEyLjE4My0uMDM3LjM2MS0uMDYyLjU0QzE2LjIyNCAxMy4wMDIgMTcgMTEuMDIzIDE3IDguODYxIDE3IDMuOTY3IDEzLjAzMyAwIDguMTM5IDAgNi44MDEgMCA1LjUzOC4zMDUgNC40LjgzNmMtLjE5Ni0uMDE3LS4zOTQtLjAzLS41OTQtLjAzek0xNSA1di4xNjZsLS4wMjgtLjE2N0wxNSA1eiIvPjxwYXRoIGZpbGw9IiNCRjY5NTIiIGQ9Ik0xMC43MjIgMTcuNzIzSDQuMjc4cy44MDUgMS42MSAzLjIyMiAxLjYxIDMuMjIyLTEuNjEgMy4yMjItMS42MXpNOCAxNS41SDdjLS4yNzYgMC0uNS0uMjI0LS41LS41cy4yMjQtLjUuNS0uNWgxYy4yNzYgMCAuNS4yMjQuNS41cy0uMjI0LjUtLjUuNXoiLz48cGF0aCBmaWxsPSIjNjYyMTEzIiBkPSJNNCAxM2MtLjU1MiAwLTEtLjQ0OC0xLTF2LTFjMC0uNTUyLjQ0OC0xIDEtMXMxIC40NDggMSAxdjFjMCAuNTUyLS40NDggMS0xIDF6bTcgMGMtLjU1MiAwLTEtLjQ0OC0xLTF2LTFjMC0uNTUyLjQ0OC0xIDEtMXMxIC40NDggMSAxdjFjMCAuNTUyLS40NDggMS0xIDF6Ii8+PHBhdGggZmlsbD0iI0Y0OTAwQyIgZD0iTTE5LjQzMiAzMi44NTJjLS4yNjQuNTExLS40MzIuOTIxLS40MzIgMS4xNDggNC42NTYgMCA5LTMgOS0zLTEuMTI1LTMuNjg4LTEuNjY2LTguMTM5LTEuNjY2LTguMTM5IDAtNC4zNDItMy41MTktNy44NjEtNy44NjEtNy44NjEtMS4yNDUgMC0yLjQxOC4yOTctMy40NjQuODEyLTMuMzMuMDctNi4wMDkgMi43ODctNi4wMDkgNi4xMzMgMCAuODI4LjE2NSAxLjYxNy40NjQgMi4zMzdDOS4yMTQgMjUuODkzIDguNzMxIDI4LjYwNCA4IDMxYzAgMCA0LjM0NCAzIDkgMyAwLS4yMjctLjE2Ny0uNjM2LS40MzEtMS4xNDZDMTMuMzkgMzIuMTk4IDExIDI5LjQgMTEgMjYuMDQ3bC4wMDItLjA0N0gxMXYtNmgzLjU1MWMxLjAxOC0uNTc0IDIuMTkyLS45MDYgMy40NDYtLjkwNnMyLjQyOS4zMzIgMy40NDYuOTA2SDI1djZoLS4wMDhsLjAwMi4wNDdjMCAzLjM1MS0yLjM4NiA2LjE0Ny01LjU2MiA2LjgwNXoiLz48cGF0aCBmaWxsPSIjRkZEQzVEIiBkPSJNMjAgMzV2LTRoLTR2NGgtMXYxaDZ2LTF6Ii8+PHBhdGggZmlsbD0iI0VBNTk2RSIgZD0iTTE0IDMzYy0yLjQ5MyAwLTQuMjc2IDEuMzg1LTQuODE0IDNIMThsLTItM2gtMnptOSAwaC0zbC0yIDNoOC44MThjLS41MTgtMS42MDItMi4xNTktMy0zLjgxOC0zeiIvPjxwYXRoIGZpbGw9IiNGRkRDNUQiIGQ9Ik0yNC45OTQgMjYuMDQ3TDI0Ljk5MiAyNkgyNXYtNmgtMy41NTdjLTEuMDE4LS41NzQtMi4xOTItLjkwNi0zLjQ0Ni0uOTA2cy0yLjQyOC4zMzItMy40NDYuOTA2SDExdjZoLjAwMmwtLjAwMi4wNDdjMCAzLjM1MyAyLjM5IDYuMTUyIDUuNTY5IDYuODA3LjQ2MS4wOTUuOTM4LjE0NiAxLjQyOC4xNDYuNDkyIDAgLjk3Mi0uMDUyIDEuNDM1LS4xNDggMy4xNzYtLjY1OCA1LjU2Mi0zLjQ1NCA1LjU2Mi02LjgwNXoiLz48cGF0aCBmaWxsPSIjRjQ5MDBDIiBkPSJNMjYgMjNsLTEtNC0zLTItMTEgMS0uODYxIDVjNS40MSAwIDguNDI1LTEuNzU1IDEwLjA2NS0zLjM2N0MyMS40NCAyMS4wOTIgMjMuNTI4IDIzIDI2IDIzeiIvPjxwYXRoIGZpbGw9IiNCRjY5NTIiIGQ9Ik0yMSAzMGgtNnMuNTgzIDIgMyAyIDMtMiAzLTJ6bS0zLS41Yy0uMTMgMC0uMjYtLjA1LS4zNS0uMTUtLjEtLjA5LS4xNS0uMjItLjE1LS4zNXMuMDUtLjI2LjE1LS4zNmMuMTctLjE3LjUyLS4xOC43MS4wMS4wOS4wOS4xNC4yMi4xNC4zNXMtLjA1LjI2LS4xNS4zNWMtLjA5LjEtLjIyLjE1LS4zNS4xNXoiLz48cGF0aCBmaWxsPSIjNjYyMTEzIiBkPSJNMTUgMjhjLS41NTIgMC0xLS40NDctMS0xdi0xYzAtLjU1My40NDgtMSAxLTFzMSAuNDQ3IDEgMXYxYzAgLjU1My0uNDQ4IDEtMSAxem02IDBjLS41NTMgMC0xLS40NDctMS0xdi0xYzAtLjU1My40NDctMSAxLTEgLjU1MyAwIDEgLjQ0NyAxIDF2MWMwIC41NTMtLjQ0NyAxLTEgMXoiLz48L3N2Zz4=',
          '👨‍👨‍👧‍👧': 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iI0ZGREM1RCIgZD0iTTI2IDIydi00aDV2NGgydjZoLTl2LTZ6Ii8+PHBhdGggZmlsbD0iIzNCOTNEOSIgZD0iTTMxIDIybC0yLjUyOCAzLjc3OEwyNiAyMmgtNWMtMiAwLTMgMS0zIDIuOTczVjM2aDE4VjIyaC01eiIvPjxwYXRoIGZpbGw9IiMxQjYzOTkiIGQ9Ik0yMC45ODYgMjZoMS4wMjh2MTBoLTEuMDI4eiIvPjxwYXRoIGZpbGw9IiNGRkRDNUQiIGQ9Ik0yMSA0bC4wMjQgMTBjLjAxMS4xNzUuMDM2LjM0Ny4wNTkuNTE4LjQ5NCAzLjY0IDMuNjE4IDYuNDUgNy40MTcgNi40NSAzLjk3OCAwIDcuMjIzLTMuMDc5IDcuNDc2LTYuOTY5SDM2VjRIMjF6Ii8+PHBhdGggZmlsbD0iI0ZGQUMzMyIgZD0iTTE5LjA0MiA4Ljg2MWMwIDIuMTUxLjc2NyA0LjEyMyAyLjA0MiA1LjY1OC0uMDIzLS4xNzItLjA0OC0uMzQzLS4wNTktLjUxOGwtLjAxLTQuMDMzYzUuMzYyLS4zMDIgOC41MTMtMi42NzUgMTAuMjAyLTQuNTdDMzEuNzgyIDcuMTcgMzMuMTE0IDEwIDM1Ljg2MSAxMEgzNlYxLjg4N0MzNC45MDYgMS4yMDYgMzMuNjE5LjgwNiAzMi4yMzYuODA2Yy0uMjAxIDAtLjM5OC4wMTQtLjU5NS4wM0MzMC41MDQuMzA1IDI5LjI0IDAgMjcuOTAyIDBjLTQuODk0IDAtOC44NiAzLjk2Ny04Ljg2IDguODYxeiIvPjxwYXRoIGZpbGw9IiNCRjY5NTIiIGQ9Ik0yNS4yNzggMTcuNzIzaDYuNDQ0cy0uODA1IDEuNjEtMy4yMjIgMS42MS0zLjIyMi0xLjYxLTMuMjIyLTEuNjF6TTI4IDE1LjVoMWMuMjc2IDAgLjUtLjIyNC41LS41cy0uMjI0LS41LS41LS41aC0xYy0uMjc2IDAtLjUuMjI0LS41LjVzLjIyNC41LjUuNXoiLz48cGF0aCBmaWxsPSIjNjYyMTEzIiBkPSJNMzIgMTNjLjU1MiAwIDEtLjQ0OCAxLTF2LTFjMC0uNTUyLS40NDgtMS0xLTFzLTEgLjQ0OC0xIDF2MWMwIC41NTIuNDQ4IDEgMSAxem0tNyAwYy41NTIgMCAxLS40NDggMS0xdi0xYzAtLjU1Mi0uNDQ4LTEtMS0xcy0xIC40NDgtMSAxdjFjMCAuNTUyLjQ0OCAxIDEgMXoiLz48cGF0aCBmaWxsPSIjRkZEQzVEIiBkPSJNNSAyMnYtNGg1djRoMnY2SDN2LTZ6Ii8+PHBhdGggZmlsbD0iIzNCOTREOSIgZD0iTTE1IDIyaC01bC0yLjQ3MiAzLjc3OEw1IDIySDB2MTRoMThWMjQuOTczQzE4IDIzIDE3IDIyIDE1IDIyeiIvPjxwYXRoIGZpbGw9IiMxQjYzOTkiIGQ9Ik0xMy45ODYgMjZoMS4wMjh2MTBoLTEuMDI4eiIvPjxwYXRoIGZpbGw9IiNGRkRDNUQiIGQ9Ik0xNSAxNFY1TDAgNHYxMGguMDI0Yy4yNTIgMy44OSAzLjQ5OCA2Ljk2OSA3LjQ3NiA2Ljk2OSAzLjc5MSAwIDYuOTMyLTIuNzk5IDcuNDM4LTYuNDI4LjAyNS0uMTguMDUtLjM1OC4wNjItLjU0MXoiLz48cGF0aCBmaWxsPSIjRkZBQzMzIiBkPSJNMy44MDYuODA2QzIuNDA1LjgwNiAxLjEwMiAxLjIxNSAwIDEuOTEydjguMDgzYzUuOTQ3LS4wNTUgOS4zNzUtMi41OTMgMTEuMTYyLTQuNTk4LjUwNiAxLjU4OSAxLjYzMyA0LjAyMSAzLjgzOCA0LjUxVjE0Yy0uMDEyLjE4My0uMDM3LjM2MS0uMDYyLjU0QzE2LjIyNCAxMy4wMDIgMTcgMTEuMDIzIDE3IDguODYxIDE3IDMuOTY3IDEzLjAzMyAwIDguMTM5IDAgNi44MDEgMCA1LjUzOC4zMDUgNC40LjgzNmMtLjE5Ni0uMDE3LS4zOTQtLjAzLS41OTQtLjAzek0xNSA1di4xNjZsLS4wMjgtLjE2N0wxNSA1eiIvPjxwYXRoIGZpbGw9IiNCRjY5NTIiIGQ9Ik0xMC43MjIgMTcuNzIzSDQuMjc4cy44MDUgMS42MSAzLjIyMiAxLjYxIDMuMjIyLTEuNjEgMy4yMjItMS42MXpNOCAxNS41SDdjLS4yNzYgMC0uNS0uMjI0LS41LS41cy4yMjQtLjUuNS0uNWgxYy4yNzYgMCAuNS4yMjQuNS41cy0uMjI0LjUtLjUuNXoiLz48cGF0aCBmaWxsPSIjNjYyMTEzIiBkPSJNNCAxM2MtLjU1MiAwLTEtLjQ0OC0xLTF2LTFjMC0uNTUyLjQ0OC0xIDEtMXMxIC40NDggMSAxdjFjMCAuNTUyLS40NDggMS0xIDF6bTcgMGMtLjU1MiAwLTEtLjQ0OC0xLTF2LTFjMC0uNTUyLjQ0OC0xIDEtMXMxIC40NDggMSAxdjFjMCAuNTUyLS40NDggMS0xIDF6Ii8+PHBhdGggZmlsbD0iI0ZGREM1RCIgZD0iTTMyLjk5OCAyMi43MTRsLTQuMjg2LS44NTctNy43MTQuODU3VjI3SDIxbC0uMDAyLjA0YzAgMy4yOTEgMi42ODUgNS45NiA1Ljk5OCA1Ljk2IDMuMzEyIDAgNS45OTctMi42NjkgNS45OTctNS45NmwtLjAwMi0uMDRoLjAwN3YtNC4yODZ6Ii8+PHBhdGggZmlsbD0iI0Y0OTAwQyIgZD0iTTMzLjk5NSAyNS4xOTJjMC0uMDIzLjAwMy0uMDQ0LjAwMy0uMDY3bC0uMDAyLS4wMzkuMDAyLS4wODYtLjAwNi4wMDZDMzMuOTI4IDIxLjY3OSAzMS4yMTYgMTkgMjcuODczIDE5Yy0uMjk4IDAtLjU4OC4wMjktLjg3NS4wNy0uMjg2LS4wNDEtLjU3Ny0uMDctLjg3NS0uMDctMy4zODMgMC02LjEyNSAyLjc0Mi02LjEyNSA2LjEyNSAwIDAgLjEyNSAzLjE4OC0xIDYuODc1IDAgMCAzLjM0NCAyIDggMnM4LTIgOC0yYy0uOTY4LTMuMTcyLTEuMDEtNi4wNjEtMS4wMDMtNi44MDh6bS0xLjAwMiAxLjg0OGMwIDMuMjkxLTIuNjg1IDUuOTYtNS45OTcgNS45NnMtNS45OTctMi42NjktNS45OTctNS45NmMtLjAwMS0uMDEzLjAwMS0uMDI3LjAwMS0uMDRoLS4wMDJ2LTEuOTExYzQuMTcyLS4xODEgNi41ODgtMS41OTIgNy45MjktMi45MS45MSAxLjA3NCAyLjM1MSAyLjQxNCA0LjA3MSAyLjgxNlYyN2gtLjAwN2wuMDAyLjA0eiIvPjxwYXRoIGZpbGw9IiNGRkRDNUQiIGQ9Ik0yOC45OTggMzR2LTNoLTR2M2gtMXYyaDZ2LTJ6Ii8+PHBhdGggZmlsbD0iI0VBNTk2RSIgZD0iTTMxLjk5OCAzM2gtM2wtMiAyLTItMmgtMmMtMi40OTMgMC00LjI3NiAxLjM4NS00LjgxNCAzaDE3LjYzMmMtLjUxOC0xLjYwMi0yLjE1OS0zLTMuODE4LTN6Ii8+PHBhdGggZmlsbD0iI0JGNjk1MiIgZD0iTTI4Ljk5OCAzMGgtNHMuMzg5IDEuMzMzIDIgMS4zMzMgMi0xLjMzMyAyLTEuMzMzem0tMi0uNWMtLjEzIDAtLjI2LS4wNS0uMzUtLjE1LS4xLS4wOS0uMTUtLjIyLS4xNS0uMzVzLjA1LS4yNi4xNS0uMzZjLjE3LS4xNy41Mi0uMTguNzEuMDEuMDkuMDkxLjE0LjIyMS4xNC4zNTFzLS4wNS4yNi0uMTUuMzVjLS4wOS4wOTktLjIyLjE0OS0uMzUuMTQ5eiIvPjxwYXRoIGZpbGw9IiM2NjIxMTMiIGQ9Ik0yOC45OTggMjhjLS40NjEgMC0uODMzLS4zNzMtLjgzMy0uODMzdi0uODMzYzAtLjQ2MS4zNzMtLjgzMy44MzMtLjgzMy40NjEgMCAuODMzLjM3My44MzMuODMzdi44MzNjLjAwMS40Ni0uMzcyLjgzMy0uODMzLjgzM3ptLTQgMGMtLjQ2MSAwLS44MzMtLjM3My0uODMzLS44MzN2LS44MzNjMC0uNDYxLjM3My0uODMzLjgzMy0uODMzLjQ2MSAwIC44MzMuMzczLjgzMy44MzN2LjgzM2MuMDAxLjQ2LS4zNzIuODMzLS44MzMuODMzeiIvPjxwYXRoIGZpbGw9IiNGRkRDNUQiIGQ9Ik0xNC45OTggMjIuNzE0bC00LjI4Ni0uODU3LTcuNzE0Ljg1N1YyN0gzbC0uMDAyLjA0YzAgMy4yOTEgMi42ODUgNS45NiA1Ljk5OCA1Ljk2IDMuMzEyIDAgNS45OTctMi42NjkgNS45OTctNS45NmwtLjAwMi0uMDRoLjAwN3YtNC4yODZ6Ii8+PHBhdGggZmlsbD0iI0Y0OTAwQyIgZD0iTTE1Ljk5NSAyNS4xOTJjMC0uMDIzLjAwMy0uMDQ0LjAwMy0uMDY3bC0uMDAyLS4wMzkuMDAyLS4wODYtLjAwNi4wMDZDMTUuOTI4IDIxLjY3OSAxMy4yMTYgMTkgOS44NzMgMTljLS4yOTggMC0uNTg4LjAyOS0uODc1LjA3LS4yODYtLjA0MS0uNTc3LS4wNy0uODc1LS4wNy0zLjM4MyAwLTYuMTI1IDIuNzQyLTYuMTI1IDYuMTI1IDAgMCAuMTI1IDMuMTg4LTEgNi44NzUgMCAwIDMuMzQ0IDIgOCAyczgtMiA4LTJjLS45NjgtMy4xNzItMS4wMS02LjA2MS0xLjAwMy02LjgwOHptLTEuMDAyIDEuODQ4YzAgMy4yOTEtMi42ODUgNS45Ni01Ljk5NyA1Ljk2cy01Ljk5Ny0yLjY2OS01Ljk5Ny01Ljk2QzIuOTk4IDI3LjAyNyAzIDI3LjAxMyAzIDI3aC0uMDAydi0xLjkxMWM0LjE3Mi0uMTgxIDYuNTg4LTEuNTkyIDcuOTI5LTIuOTEuOTEgMS4wNzQgMi4zNTEgMi40MTQgNC4wNzEgMi44MTZWMjdoLS4wMDdsLjAwMi4wNHoiLz48cGF0aCBmaWxsPSIjRkZEQzVEIiBkPSJNMTAuOTk4IDM0di0zaC00djNoLTF2Mmg2di0yeiIvPjxwYXRoIGZpbGw9IiNFQTU5NkUiIGQ9Ik0xMy45OTggMzNoLTNsLTIgMi0yLTJoLTJDMi41MDUgMzMgLjcyMiAzNC4zODUuMTg0IDM2aDE3LjYzMmMtLjUxOC0xLjYwMi0yLjE1OS0zLTMuODE4LTN6Ii8+PHBhdGggZmlsbD0iI0JGNjk1MiIgZD0iTTEwLjk5OCAzMGgtNHMuMzg5IDEuMzMzIDIgMS4zMzMgMi0xLjMzMyAyLTEuMzMzem0tMi0uNWMtLjEzIDAtLjI2LS4wNS0uMzUtLjE1LS4xLS4wOS0uMTUtLjIyLS4xNS0uMzVzLjA1LS4yNi4xNS0uMzZjLjE3LS4xNy41Mi0uMTguNzEuMDEuMDkuMDkxLjE0LjIyMS4xNC4zNTFzLS4wNS4yNi0uMTUuMzVjLS4wOS4wOTktLjIyLjE0OS0uMzUuMTQ5eiIvPjxwYXRoIGZpbGw9IiM2NjIxMTMiIGQ9Ik0xMC45OTggMjhjLS40NjEgMC0uODMzLS4zNzMtLjgzMy0uODMzdi0uODMzYzAtLjQ2MS4zNzMtLjgzMy44MzMtLjgzMy40NjEgMCAuODMzLjM3My44MzMuODMzdi44MzNjLjAwMS40Ni0uMzcyLjgzMy0uODMzLjgzM3ptLTQgMGMtLjQ2MSAwLS44MzMtLjM3My0uODMzLS44MzN2LS44MzNjMC0uNDYxLjM3My0uODMzLjgzMy0uODMzLjQ2MSAwIC44MzMuMzczLjgzMy44MzN2LjgzM2MuMDAxLjQ2LS4zNzIuODMzLS44MzMuODMzeiIvPjwvc3ZnPg==',
        },
      }
    )

    expect(await toImage(svg)).toMatchImageSnapshot()
  })

  it('should render emojis correctly with `word-break: break-all`', async () => {
    const svg = await satori(
      <div
        style={{
          backgroundColor: '#fff',
          wordBreak: 'break-all',
        }}
      >
        🌈 🏳️‍🌈 Luci, 👨‍👨‍👧Nyan👨‍👨‍👧‍👧
      </div>,
      {
        width: 200,
        height: 100,
        fonts,
        graphemeImages: {
          '🌈': 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iIzg3NjdBQyIgZD0iTTM2IDFDMTYuMTE4IDEgMSAxNi4xMTggMSAzNmgxNy4wNDJjMC05LjkxNyA4LjA0Mi0xNy45NTggMTcuOTU4LTE3Ljk1OFYxeiIvPjxwYXRoIGZpbGw9IiNFQjIwMjciIGQ9Ik0wIDM1Ljk5OWgzLjA0MmMwLTE4LjE4OSAxNC43MzQtMzIuOTM1IDMyLjkxNy0zMi45NTdWMEMxNi4wOTUuMDIzIDAgMTYuMTMxIDAgMzUuOTk5eiIvPjxwYXRoIGZpbGw9IiNGMTkwMjAiIGQ9Ik0zLjA4MyAzNmgzQzYuMDgzIDE5LjQ2OCAxOS40NzMgNi4wNjUgMzYgNi4wNDN2LTNDMTcuODE3IDMuMDY1IDMuMDgzIDE3LjgxMSAzLjA4MyAzNnoiLz48cGF0aCBmaWxsPSIjRkZDQjRDIiBkPSJNNi4wODMgMzZoM0M5LjA4MyAyMS4xMjUgMjEuMTMgOS4wNjUgMzYgOS4wNDN2LTNDMTkuNDczIDYuMDY1IDYuMDgzIDE5LjQ2OCA2LjA4MyAzNnoiLz48cGF0aCBmaWxsPSIjNUM5MDNGIiBkPSJNOS4wODMgMzZoM2MwLTEzLjIxNyAxMC43MDUtMjMuOTM1IDIzLjkxNy0yMy45NTd2LTNDMjEuMTMgOS4wNjUgOS4wODMgMjEuMTI1IDkuMDgzIDM2eiIvPjxwYXRoIGZpbGw9IiMyMjY3OTgiIGQ9Ik0xMi4wODMgMzZoM2MwLTExLjU2IDkuMzYyLTIwLjkzNCAyMC45MTctMjAuOTU2di0zLjAwMUMyMi43ODggMTIuMDY1IDEyLjA4MyAyMi43ODMgMTIuMDgzIDM2eiIvPjwvc3ZnPg==',
          '🏳️‍🌈': 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZmlsbD0iIzg4MDA4MiIgZD0iTTAgMjdhNCA0IDAgMCAwIDQgNGgyOGE0IDQgMCAwIDAgNC00di0uNUgwdi41eiIvPjxwYXRoIGZpbGw9IiMzNTU4QTAiIGQ9Ik0wIDIyLjA3aDM2djQuNkgweiIvPjxwYXRoIGZpbGw9IiMxMzhGM0UiIGQ9Ik0wIDE3LjgzaDM2djQuNUgweiIvPjxwYXRoIGZpbGw9IiNGQUQyMjAiIGQ9Ik0wIDEzLjVoMzZWMThIMHoiLz48cGF0aCBmaWxsPSIjRkY3MzAwIiBkPSJNMCA5LjE3aDM2djQuNUgweiIvPjxwYXRoIGZpbGw9IiNGRjAwMEUiIGQ9Ik0zMiA1SDRhNCA0IDAgMCAwLTQgNHYuMzNoMzZWOWE0IDQgMCAwIDAtNC00eiIvPjwvc3ZnPg==',
          '👨‍👨‍👧': 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iI0ZGREM1RCIgZD0iTTI2IDIydi00aDV2NGgydjZoLTl2LTZ6Ii8+PHBhdGggZmlsbD0iIzNCOTNEOSIgZD0iTTMxIDIybC0yLjUyOCAzLjc3OEwyNiAyMmgtNWMtMiAwLTMgMS0zIDIuOTczVjM2aDE4VjIyaC01eiIvPjxwYXRoIGZpbGw9IiMxQjYzOTkiIGQ9Ik0yMC45ODYgMjZoMS4wMjh2MTBoLTEuMDI4eiIvPjxwYXRoIGZpbGw9IiNGRkRDNUQiIGQ9Ik0yMSA0bC4wMjQgMTBjLjAxMS4xNzUuMDM2LjM0Ny4wNTkuNTE4LjQ5NCAzLjY0IDMuNjE4IDYuNDUgNy40MTcgNi40NSAzLjk3OCAwIDcuMjIzLTMuMDc5IDcuNDc2LTYuOTY5SDM2VjRIMjF6Ii8+PHBhdGggZmlsbD0iI0ZGQUMzMyIgZD0iTTE5LjA0MiA4Ljg2MWMwIDIuMTUxLjc2NyA0LjEyMyAyLjA0MiA1LjY1OC0uMDIzLS4xNzItLjA0OC0uMzQzLS4wNTktLjUxOGwtLjAxLTQuMDMzYzUuMzYyLS4zMDIgOC41MTMtMi42NzUgMTAuMjAyLTQuNTdDMzEuNzgyIDcuMTcgMzMuMTE0IDEwIDM1Ljg2MSAxMEgzNlYxLjg4N0MzNC45MDYgMS4yMDYgMzMuNjE5LjgwNiAzMi4yMzYuODA2Yy0uMjAxIDAtLjM5OC4wMTQtLjU5NS4wM0MzMC41MDQuMzA1IDI5LjI0IDAgMjcuOTAyIDBjLTQuODk0IDAtOC44NiAzLjk2Ny04Ljg2IDguODYxeiIvPjxwYXRoIGZpbGw9IiNCRjY5NTIiIGQ9Ik0yNS4yNzggMTcuNzIzaDYuNDQ0cy0uODA1IDEuNjEtMy4yMjIgMS42MS0zLjIyMi0xLjYxLTMuMjIyLTEuNjF6TTI4IDE1LjVoMWMuMjc2IDAgLjUtLjIyNC41LS41cy0uMjI0LS41LS41LS41aC0xYy0uMjc2IDAtLjUuMjI0LS41LjVzLjIyNC41LjUuNXoiLz48cGF0aCBmaWxsPSIjNjYyMTEzIiBkPSJNMzIgMTNjLjU1MiAwIDEtLjQ0OCAxLTF2LTFjMC0uNTUyLS40NDgtMS0xLTFzLTEgLjQ0OC0xIDF2MWMwIC41NTIuNDQ4IDEgMSAxem0tNyAwYy41NTIgMCAxLS40NDggMS0xdi0xYzAtLjU1Mi0uNDQ4LTEtMS0xcy0xIC40NDgtMSAxdjFjMCAuNTUyLjQ0OCAxIDEgMXoiLz48cGF0aCBmaWxsPSIjRkZEQzVEIiBkPSJNNSAyMnYtNGg1djRoMnY2SDN2LTZ6Ii8+PHBhdGggZmlsbD0iIzNCOTREOSIgZD0iTTE1IDIyaC01bC0yLjQ3MiAzLjc3OEw1IDIySDB2MTRoMThWMjQuOTczQzE4IDIzIDE3IDIyIDE1IDIyeiIvPjxwYXRoIGZpbGw9IiMxQjYzOTkiIGQ9Ik0xMy45ODYgMjZoMS4wMjh2MTBoLTEuMDI4eiIvPjxwYXRoIGZpbGw9IiNGRkRDNUQiIGQ9Ik0xNSAxNFY1TDAgNHYxMGguMDI0Yy4yNTIgMy44OSAzLjQ5OCA2Ljk2OSA3LjQ3NiA2Ljk2OSAzLjc5MSAwIDYuOTMyLTIuNzk5IDcuNDM4LTYuNDI4LjAyNS0uMTguMDUtLjM1OC4wNjItLjU0MXoiLz48cGF0aCBmaWxsPSIjRkZBQzMzIiBkPSJNMy44MDYuODA2QzIuNDA1LjgwNiAxLjEwMiAxLjIxNSAwIDEuOTEydjguMDgzYzUuOTQ3LS4wNTUgOS4zNzUtMi41OTMgMTEuMTYyLTQuNTk4LjUwNiAxLjU4OSAxLjYzMyA0LjAyMSAzLjgzOCA0LjUxVjE0Yy0uMDEyLjE4My0uMDM3LjM2MS0uMDYyLjU0QzE2LjIyNCAxMy4wMDIgMTcgMTEuMDIzIDE3IDguODYxIDE3IDMuOTY3IDEzLjAzMyAwIDguMTM5IDAgNi44MDEgMCA1LjUzOC4zMDUgNC40LjgzNmMtLjE5Ni0uMDE3LS4zOTQtLjAzLS41OTQtLjAzek0xNSA1di4xNjZsLS4wMjgtLjE2N0wxNSA1eiIvPjxwYXRoIGZpbGw9IiNCRjY5NTIiIGQ9Ik0xMC43MjIgMTcuNzIzSDQuMjc4cy44MDUgMS42MSAzLjIyMiAxLjYxIDMuMjIyLTEuNjEgMy4yMjItMS42MXpNOCAxNS41SDdjLS4yNzYgMC0uNS0uMjI0LS41LS41cy4yMjQtLjUuNS0uNWgxYy4yNzYgMCAuNS4yMjQuNS41cy0uMjI0LjUtLjUuNXoiLz48cGF0aCBmaWxsPSIjNjYyMTEzIiBkPSJNNCAxM2MtLjU1MiAwLTEtLjQ0OC0xLTF2LTFjMC0uNTUyLjQ0OC0xIDEtMXMxIC40NDggMSAxdjFjMCAuNTUyLS40NDggMS0xIDF6bTcgMGMtLjU1MiAwLTEtLjQ0OC0xLTF2LTFjMC0uNTUyLjQ0OC0xIDEtMXMxIC40NDggMSAxdjFjMCAuNTUyLS40NDggMS0xIDF6Ii8+PHBhdGggZmlsbD0iI0Y0OTAwQyIgZD0iTTE5LjQzMiAzMi44NTJjLS4yNjQuNTExLS40MzIuOTIxLS40MzIgMS4xNDggNC42NTYgMCA5LTMgOS0zLTEuMTI1LTMuNjg4LTEuNjY2LTguMTM5LTEuNjY2LTguMTM5IDAtNC4zNDItMy41MTktNy44NjEtNy44NjEtNy44NjEtMS4yNDUgMC0yLjQxOC4yOTctMy40NjQuODEyLTMuMzMuMDctNi4wMDkgMi43ODctNi4wMDkgNi4xMzMgMCAuODI4LjE2NSAxLjYxNy40NjQgMi4zMzdDOS4yMTQgMjUuODkzIDguNzMxIDI4LjYwNCA4IDMxYzAgMCA0LjM0NCAzIDkgMyAwLS4yMjctLjE2Ny0uNjM2LS40MzEtMS4xNDZDMTMuMzkgMzIuMTk4IDExIDI5LjQgMTEgMjYuMDQ3bC4wMDItLjA0N0gxMXYtNmgzLjU1MWMxLjAxOC0uNTc0IDIuMTkyLS45MDYgMy40NDYtLjkwNnMyLjQyOS4zMzIgMy40NDYuOTA2SDI1djZoLS4wMDhsLjAwMi4wNDdjMCAzLjM1MS0yLjM4NiA2LjE0Ny01LjU2MiA2LjgwNXoiLz48cGF0aCBmaWxsPSIjRkZEQzVEIiBkPSJNMjAgMzV2LTRoLTR2NGgtMXYxaDZ2LTF6Ii8+PHBhdGggZmlsbD0iI0VBNTk2RSIgZD0iTTE0IDMzYy0yLjQ5MyAwLTQuMjc2IDEuMzg1LTQuODE0IDNIMThsLTItM2gtMnptOSAwaC0zbC0yIDNoOC44MThjLS41MTgtMS42MDItMi4xNTktMy0zLjgxOC0zeiIvPjxwYXRoIGZpbGw9IiNGRkRDNUQiIGQ9Ik0yNC45OTQgMjYuMDQ3TDI0Ljk5MiAyNkgyNXYtNmgtMy41NTdjLTEuMDE4LS41NzQtMi4xOTItLjkwNi0zLjQ0Ni0uOTA2cy0yLjQyOC4zMzItMy40NDYuOTA2SDExdjZoLjAwMmwtLjAwMi4wNDdjMCAzLjM1MyAyLjM5IDYuMTUyIDUuNTY5IDYuODA3LjQ2MS4wOTUuOTM4LjE0NiAxLjQyOC4xNDYuNDkyIDAgLjk3Mi0uMDUyIDEuNDM1LS4xNDggMy4xNzYtLjY1OCA1LjU2Mi0zLjQ1NCA1LjU2Mi02LjgwNXoiLz48cGF0aCBmaWxsPSIjRjQ5MDBDIiBkPSJNMjYgMjNsLTEtNC0zLTItMTEgMS0uODYxIDVjNS40MSAwIDguNDI1LTEuNzU1IDEwLjA2NS0zLjM2N0MyMS40NCAyMS4wOTIgMjMuNTI4IDIzIDI2IDIzeiIvPjxwYXRoIGZpbGw9IiNCRjY5NTIiIGQ9Ik0yMSAzMGgtNnMuNTgzIDIgMyAyIDMtMiAzLTJ6bS0zLS41Yy0uMTMgMC0uMjYtLjA1LS4zNS0uMTUtLjEtLjA5LS4xNS0uMjItLjE1LS4zNXMuMDUtLjI2LjE1LS4zNmMuMTctLjE3LjUyLS4xOC43MS4wMS4wOS4wOS4xNC4yMi4xNC4zNXMtLjA1LjI2LS4xNS4zNWMtLjA5LjEtLjIyLjE1LS4zNS4xNXoiLz48cGF0aCBmaWxsPSIjNjYyMTEzIiBkPSJNMTUgMjhjLS41NTIgMC0xLS40NDctMS0xdi0xYzAtLjU1My40NDgtMSAxLTFzMSAuNDQ3IDEgMXYxYzAgLjU1My0uNDQ4IDEtMSAxem02IDBjLS41NTMgMC0xLS40NDctMS0xdi0xYzAtLjU1My40NDctMSAxLTEgLjU1MyAwIDEgLjQ0NyAxIDF2MWMwIC41NTMtLjQ0NyAxLTEgMXoiLz48L3N2Zz4=',
          '👨‍👨‍👧‍👧': 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iI0ZGREM1RCIgZD0iTTI2IDIydi00aDV2NGgydjZoLTl2LTZ6Ii8+PHBhdGggZmlsbD0iIzNCOTNEOSIgZD0iTTMxIDIybC0yLjUyOCAzLjc3OEwyNiAyMmgtNWMtMiAwLTMgMS0zIDIuOTczVjM2aDE4VjIyaC01eiIvPjxwYXRoIGZpbGw9IiMxQjYzOTkiIGQ9Ik0yMC45ODYgMjZoMS4wMjh2MTBoLTEuMDI4eiIvPjxwYXRoIGZpbGw9IiNGRkRDNUQiIGQ9Ik0yMSA0bC4wMjQgMTBjLjAxMS4xNzUuMDM2LjM0Ny4wNTkuNTE4LjQ5NCAzLjY0IDMuNjE4IDYuNDUgNy40MTcgNi40NSAzLjk3OCAwIDcuMjIzLTMuMDc5IDcuNDc2LTYuOTY5SDM2VjRIMjF6Ii8+PHBhdGggZmlsbD0iI0ZGQUMzMyIgZD0iTTE5LjA0MiA4Ljg2MWMwIDIuMTUxLjc2NyA0LjEyMyAyLjA0MiA1LjY1OC0uMDIzLS4xNzItLjA0OC0uMzQzLS4wNTktLjUxOGwtLjAxLTQuMDMzYzUuMzYyLS4zMDIgOC41MTMtMi42NzUgMTAuMjAyLTQuNTdDMzEuNzgyIDcuMTcgMzMuMTE0IDEwIDM1Ljg2MSAxMEgzNlYxLjg4N0MzNC45MDYgMS4yMDYgMzMuNjE5LjgwNiAzMi4yMzYuODA2Yy0uMjAxIDAtLjM5OC4wMTQtLjU5NS4wM0MzMC41MDQuMzA1IDI5LjI0IDAgMjcuOTAyIDBjLTQuODk0IDAtOC44NiAzLjk2Ny04Ljg2IDguODYxeiIvPjxwYXRoIGZpbGw9IiNCRjY5NTIiIGQ9Ik0yNS4yNzggMTcuNzIzaDYuNDQ0cy0uODA1IDEuNjEtMy4yMjIgMS42MS0zLjIyMi0xLjYxLTMuMjIyLTEuNjF6TTI4IDE1LjVoMWMuMjc2IDAgLjUtLjIyNC41LS41cy0uMjI0LS41LS41LS41aC0xYy0uMjc2IDAtLjUuMjI0LS41LjVzLjIyNC41LjUuNXoiLz48cGF0aCBmaWxsPSIjNjYyMTEzIiBkPSJNMzIgMTNjLjU1MiAwIDEtLjQ0OCAxLTF2LTFjMC0uNTUyLS40NDgtMS0xLTFzLTEgLjQ0OC0xIDF2MWMwIC41NTIuNDQ4IDEgMSAxem0tNyAwYy41NTIgMCAxLS40NDggMS0xdi0xYzAtLjU1Mi0uNDQ4LTEtMS0xcy0xIC40NDgtMSAxdjFjMCAuNTUyLjQ0OCAxIDEgMXoiLz48cGF0aCBmaWxsPSIjRkZEQzVEIiBkPSJNNSAyMnYtNGg1djRoMnY2SDN2LTZ6Ii8+PHBhdGggZmlsbD0iIzNCOTREOSIgZD0iTTE1IDIyaC01bC0yLjQ3MiAzLjc3OEw1IDIySDB2MTRoMThWMjQuOTczQzE4IDIzIDE3IDIyIDE1IDIyeiIvPjxwYXRoIGZpbGw9IiMxQjYzOTkiIGQ9Ik0xMy45ODYgMjZoMS4wMjh2MTBoLTEuMDI4eiIvPjxwYXRoIGZpbGw9IiNGRkRDNUQiIGQ9Ik0xNSAxNFY1TDAgNHYxMGguMDI0Yy4yNTIgMy44OSAzLjQ5OCA2Ljk2OSA3LjQ3NiA2Ljk2OSAzLjc5MSAwIDYuOTMyLTIuNzk5IDcuNDM4LTYuNDI4LjAyNS0uMTguMDUtLjM1OC4wNjItLjU0MXoiLz48cGF0aCBmaWxsPSIjRkZBQzMzIiBkPSJNMy44MDYuODA2QzIuNDA1LjgwNiAxLjEwMiAxLjIxNSAwIDEuOTEydjguMDgzYzUuOTQ3LS4wNTUgOS4zNzUtMi41OTMgMTEuMTYyLTQuNTk4LjUwNiAxLjU4OSAxLjYzMyA0LjAyMSAzLjgzOCA0LjUxVjE0Yy0uMDEyLjE4My0uMDM3LjM2MS0uMDYyLjU0QzE2LjIyNCAxMy4wMDIgMTcgMTEuMDIzIDE3IDguODYxIDE3IDMuOTY3IDEzLjAzMyAwIDguMTM5IDAgNi44MDEgMCA1LjUzOC4zMDUgNC40LjgzNmMtLjE5Ni0uMDE3LS4zOTQtLjAzLS41OTQtLjAzek0xNSA1di4xNjZsLS4wMjgtLjE2N0wxNSA1eiIvPjxwYXRoIGZpbGw9IiNCRjY5NTIiIGQ9Ik0xMC43MjIgMTcuNzIzSDQuMjc4cy44MDUgMS42MSAzLjIyMiAxLjYxIDMuMjIyLTEuNjEgMy4yMjItMS42MXpNOCAxNS41SDdjLS4yNzYgMC0uNS0uMjI0LS41LS41cy4yMjQtLjUuNS0uNWgxYy4yNzYgMCAuNS4yMjQuNS41cy0uMjI0LjUtLjUuNXoiLz48cGF0aCBmaWxsPSIjNjYyMTEzIiBkPSJNNCAxM2MtLjU1MiAwLTEtLjQ0OC0xLTF2LTFjMC0uNTUyLjQ0OC0xIDEtMXMxIC40NDggMSAxdjFjMCAuNTUyLS40NDggMS0xIDF6bTcgMGMtLjU1MiAwLTEtLjQ0OC0xLTF2LTFjMC0uNTUyLjQ0OC0xIDEtMXMxIC40NDggMSAxdjFjMCAuNTUyLS40NDggMS0xIDF6Ii8+PHBhdGggZmlsbD0iI0ZGREM1RCIgZD0iTTMyLjk5OCAyMi43MTRsLTQuMjg2LS44NTctNy43MTQuODU3VjI3SDIxbC0uMDAyLjA0YzAgMy4yOTEgMi42ODUgNS45NiA1Ljk5OCA1Ljk2IDMuMzEyIDAgNS45OTctMi42NjkgNS45OTctNS45NmwtLjAwMi0uMDRoLjAwN3YtNC4yODZ6Ii8+PHBhdGggZmlsbD0iI0Y0OTAwQyIgZD0iTTMzLjk5NSAyNS4xOTJjMC0uMDIzLjAwMy0uMDQ0LjAwMy0uMDY3bC0uMDAyLS4wMzkuMDAyLS4wODYtLjAwNi4wMDZDMzMuOTI4IDIxLjY3OSAzMS4yMTYgMTkgMjcuODczIDE5Yy0uMjk4IDAtLjU4OC4wMjktLjg3NS4wNy0uMjg2LS4wNDEtLjU3Ny0uMDctLjg3NS0uMDctMy4zODMgMC02LjEyNSAyLjc0Mi02LjEyNSA2LjEyNSAwIDAgLjEyNSAzLjE4OC0xIDYuODc1IDAgMCAzLjM0NCAyIDggMnM4LTIgOC0yYy0uOTY4LTMuMTcyLTEuMDEtNi4wNjEtMS4wMDMtNi44MDh6bS0xLjAwMiAxLjg0OGMwIDMuMjkxLTIuNjg1IDUuOTYtNS45OTcgNS45NnMtNS45OTctMi42NjktNS45OTctNS45NmMtLjAwMS0uMDEzLjAwMS0uMDI3LjAwMS0uMDRoLS4wMDJ2LTEuOTExYzQuMTcyLS4xODEgNi41ODgtMS41OTIgNy45MjktMi45MS45MSAxLjA3NCAyLjM1MSAyLjQxNCA0LjA3MSAyLjgxNlYyN2gtLjAwN2wuMDAyLjA0eiIvPjxwYXRoIGZpbGw9IiNGRkRDNUQiIGQ9Ik0yOC45OTggMzR2LTNoLTR2M2gtMXYyaDZ2LTJ6Ii8+PHBhdGggZmlsbD0iI0VBNTk2RSIgZD0iTTMxLjk5OCAzM2gtM2wtMiAyLTItMmgtMmMtMi40OTMgMC00LjI3NiAxLjM4NS00LjgxNCAzaDE3LjYzMmMtLjUxOC0xLjYwMi0yLjE1OS0zLTMuODE4LTN6Ii8+PHBhdGggZmlsbD0iI0JGNjk1MiIgZD0iTTI4Ljk5OCAzMGgtNHMuMzg5IDEuMzMzIDIgMS4zMzMgMi0xLjMzMyAyLTEuMzMzem0tMi0uNWMtLjEzIDAtLjI2LS4wNS0uMzUtLjE1LS4xLS4wOS0uMTUtLjIyLS4xNS0uMzVzLjA1LS4yNi4xNS0uMzZjLjE3LS4xNy41Mi0uMTguNzEuMDEuMDkuMDkxLjE0LjIyMS4xNC4zNTFzLS4wNS4yNi0uMTUuMzVjLS4wOS4wOTktLjIyLjE0OS0uMzUuMTQ5eiIvPjxwYXRoIGZpbGw9IiM2NjIxMTMiIGQ9Ik0yOC45OTggMjhjLS40NjEgMC0uODMzLS4zNzMtLjgzMy0uODMzdi0uODMzYzAtLjQ2MS4zNzMtLjgzMy44MzMtLjgzMy40NjEgMCAuODMzLjM3My44MzMuODMzdi44MzNjLjAwMS40Ni0uMzcyLjgzMy0uODMzLjgzM3ptLTQgMGMtLjQ2MSAwLS44MzMtLjM3My0uODMzLS44MzN2LS44MzNjMC0uNDYxLjM3My0uODMzLjgzMy0uODMzLjQ2MSAwIC44MzMuMzczLjgzMy44MzN2LjgzM2MuMDAxLjQ2LS4zNzIuODMzLS44MzMuODMzeiIvPjxwYXRoIGZpbGw9IiNGRkRDNUQiIGQ9Ik0xNC45OTggMjIuNzE0bC00LjI4Ni0uODU3LTcuNzE0Ljg1N1YyN0gzbC0uMDAyLjA0YzAgMy4yOTEgMi42ODUgNS45NiA1Ljk5OCA1Ljk2IDMuMzEyIDAgNS45OTctMi42NjkgNS45OTctNS45NmwtLjAwMi0uMDRoLjAwN3YtNC4yODZ6Ii8+PHBhdGggZmlsbD0iI0Y0OTAwQyIgZD0iTTE1Ljk5NSAyNS4xOTJjMC0uMDIzLjAwMy0uMDQ0LjAwMy0uMDY3bC0uMDAyLS4wMzkuMDAyLS4wODYtLjAwNi4wMDZDMTUuOTI4IDIxLjY3OSAxMy4yMTYgMTkgOS44NzMgMTljLS4yOTggMC0uNTg4LjAyOS0uODc1LjA3LS4yODYtLjA0MS0uNTc3LS4wNy0uODc1LS4wNy0zLjM4MyAwLTYuMTI1IDIuNzQyLTYuMTI1IDYuMTI1IDAgMCAuMTI1IDMuMTg4LTEgNi44NzUgMCAwIDMuMzQ0IDIgOCAyczgtMiA4LTJjLS45NjgtMy4xNzItMS4wMS02LjA2MS0xLjAwMy02LjgwOHptLTEuMDAyIDEuODQ4YzAgMy4yOTEtMi42ODUgNS45Ni01Ljk5NyA1Ljk2cy01Ljk5Ny0yLjY2OS01Ljk5Ny01Ljk2QzIuOTk4IDI3LjAyNyAzIDI3LjAxMyAzIDI3aC0uMDAydi0xLjkxMWM0LjE3Mi0uMTgxIDYuNTg4LTEuNTkyIDcuOTI5LTIuOTEuOTEgMS4wNzQgMi4zNTEgMi40MTQgNC4wNzEgMi44MTZWMjdoLS4wMDdsLjAwMi4wNHoiLz48cGF0aCBmaWxsPSIjRkZEQzVEIiBkPSJNMTAuOTk4IDM0di0zaC00djNoLTF2Mmg2di0yeiIvPjxwYXRoIGZpbGw9IiNFQTU5NkUiIGQ9Ik0xMy45OTggMzNoLTNsLTIgMi0yLTJoLTJDMi41MDUgMzMgLjcyMiAzNC4zODUuMTg0IDM2aDE3LjYzMmMtLjUxOC0xLjYwMi0yLjE1OS0zLTMuODE4LTN6Ii8+PHBhdGggZmlsbD0iI0JGNjk1MiIgZD0iTTEwLjk5OCAzMGgtNHMuMzg5IDEuMzMzIDIgMS4zMzMgMi0xLjMzMyAyLTEuMzMzem0tMi0uNWMtLjEzIDAtLjI2LS4wNS0uMzUtLjE1LS4xLS4wOS0uMTUtLjIyLS4xNS0uMzVzLjA1LS4yNi4xNS0uMzZjLjE3LS4xNy41Mi0uMTguNzEuMDEuMDkuMDkxLjE0LjIyMS4xNC4zNTFzLS4wNS4yNi0uMTUuMzVjLS4wOS4wOTktLjIyLjE0OS0uMzUuMTQ5eiIvPjxwYXRoIGZpbGw9IiM2NjIxMTMiIGQ9Ik0xMC45OTggMjhjLS40NjEgMC0uODMzLS4zNzMtLjgzMy0uODMzdi0uODMzYzAtLjQ2MS4zNzMtLjgzMy44MzMtLjgzMy40NjEgMCAuODMzLjM3My44MzMuODMzdi44MzNjLjAwMS40Ni0uMzcyLjgzMy0uODMzLjgzM3ptLTQgMGMtLjQ2MSAwLS44MzMtLjM3My0uODMzLS44MzN2LS44MzNjMC0uNDYxLjM3My0uODMzLjgzMy0uODMzLjQ2MSAwIC44MzMuMzczLjgzMy44MzN2LjgzM2MuMDAxLjQ2LS4zNzIuODMzLS44MzMuODMzeiIvPjwvc3ZnPg==',
        },
      }
    )

    expect(await toImage(svg)).toMatchImageSnapshot()
  })

  it('should render emojis correctly with alphabetic emoji', async () => {
    const svg = await satori(
      <div
        style={{
          height: '100%',
          width: '100%',
          display: 'flex',
          flexDirection: 'column',
          alignItems: 'center',
          justifyContent: 'center',
          backgroundColor: '#fff',
        }}
      >
        <div>⚡Hello⚡</div>
        <div>⚡ Hello ⚡</div>
        <div>🚀Hello🚀</div>
        <div>🚀 Hello 🚀</div>
      </div>,
      {
        width: 200,
        height: 100,
        fonts,
        graphemeImages: {
          '⚡': 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iI0ZGQUMzMyIgZD0iTTMyLjkzOCAxNS42NTFDMzIuNzkyIDE1LjI2IDMyLjQxOCAxNSAzMiAxNUgxOS45MjVMMjYuODkgMS40NThjLjIxOS0uNDI2LjEwNi0uOTQ3LS4yNzEtMS4yNDNDMjYuNDM3LjA3MSAyNi4yMTggMCAyNiAwYy0uMjMzIDAtLjQ2Ni4wODItLjY1My4yNDNMMTggNi41ODggMy4zNDcgMTkuMjQzYy0uMzE2LjI3My0uNDMuNzE0LS4yODQgMS4xMDVTMy41ODIgMjEgNCAyMWgxMi4wNzVMOS4xMSAzNC41NDJjLS4yMTkuNDI2LS4xMDYuOTQ3LjI3MSAxLjI0My4xODIuMTQ0LjQwMS4yMTUuNjE5LjIxNS4yMzMgMCAuNDY2LS4wODIuNjUzLS4yNDNMMTggMjkuNDEybDE0LjY1My0xMi42NTVjLjMxNy0uMjczLjQzLS43MTQuMjg1LTEuMTA2eiIvPjwvc3ZnPg==',
          '🚀': 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iI0EwMDQxRSIgZD0iTTEgMTdsOC03IDE2IDEgMSAxNi03IDhzLjAwMS01Ljk5OS02LTEyLTEyLTYtMTItNnoiLz48cGF0aCBmaWxsPSIjRkZBQzMzIiBkPSJNLjk3MyAzNXMtLjAzNi03Ljk3OSAyLjk4NS0xMVMxNSAyMS4xODcgMTUgMjEuMTg3IDE0Ljk5OSAyOSAxMS45OTkgMzJjLTMgMy0xMS4wMjYgMy0xMS4wMjYgM3oiLz48Y2lyY2xlIGZpbGw9IiNGRkNDNEQiIGN4PSI4Ljk5OSIgY3k9IjI3IiByPSI0Ii8+PHBhdGggZmlsbD0iIzU1QUNFRSIgZD0iTTM1Ljk5OSAwcy0xMCAwLTIyIDEwYy02IDUtNiAxNC00IDE2czExIDIgMTYtNGMxMC0xMiAxMC0yMiAxMC0yMnoiLz48cGF0aCBkPSJNMjYuOTk5IDVjLTEuNjIzIDAtMy4wMTMuOTcxLTMuNjQxIDIuMzYuNTAyLS4yMjcgMS4wNTUtLjM2IDEuNjQxLS4zNiAyLjIwOSAwIDQgMS43OTEgNCA0IDAgLjU4Ni0uMTMzIDEuMTM5LS4zNTkgMS42NCAxLjM4OS0uNjI3IDIuMzU5LTIuMDE3IDIuMzU5LTMuNjQgMC0yLjIwOS0xLjc5MS00LTQtNHoiLz48cGF0aCBmaWxsPSIjQTAwNDFFIiBkPSJNOCAyOHMwLTQgMS01IDEzLjAwMS0xMC45OTkgMTQtMTAtOS4wMDEgMTMtMTAuMDAxIDE0UzggMjggOCAyOHoiLz48L3N2Zz4=',
        },
      }
    )

    expect(await toImage(svg)).toMatchImageSnapshot()
  })
})
